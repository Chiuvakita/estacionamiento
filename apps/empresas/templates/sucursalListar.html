{% load static %}
{% include "navbarAdmin.html" %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Listado de Sucursales</title>
</head>
<body>
    <div class="actions" style="margin: 10px 0;">
        <a class="button" href="{% url 'empresas_listar' %}">Volver</a>
        <a class="button" href="{% url 'sucursales_crear' empresa_id %}">Crear nueva sucursal</a>
    </div>
    <h1>Listado de Sucursales</h1>
    <table>
        <thead>
            <tr>
                <th>Nombre</th>
            </tr>
        </thead>
        <tbody>
            {% for sucursal in sucursales %}
            <tr class="accordion-header" data-id="{{ sucursal.id }}" style="cursor:pointer;">
                <td style="display:flex; justify-content:space-between; align-items:center;">
                    <div>
                        <span class="arrow" id="arrow-{{ sucursal.id }}">▶</span>
                        <strong>{{ sucursal.nombreSucursal }}</strong>
                    </div>

                    <div style="display:flex; gap:10px;">
                        <form action="{% url 'sucursales_eliminar' empresa_id sucursal.id %}" method="POST">
                            {% csrf_token %}
                            <button class="button button-danger" type="submit"
                                onclick="return confirm('¿Eliminar sucursal?');">
                                Eliminar
                            </button>
                        </form>
                    </div>
                </td>
            </tr>

            <tr class="accordion-content" id="content-{{ sucursal.id }}" style="display:none;">
                <td>
                    <p><strong>Dirección:</strong> {{ sucursal.direccion }}</p>
                    <p><strong>Número:</strong> {{ sucursal.numero }}</p>
                    <p><strong>Cantidad Estacionamientos:</strong> {{ sucursal.cantidadEstacionamiento }}</p>

                    <div style="margin-top:10px;">
                        <a class="button" href="{% url 'sucursales_editar' empresa_id sucursal.id %}">Editar</a>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>

    </table>
</body>
</html>

<script>
document.querySelectorAll(".accordion-header").forEach(header => {
    header.addEventListener("click", () => {
        const id = header.getAttribute("data-id");
        const content = document.getElementById(`content-${id}`);
        const arrow = document.getElementById(`arrow-${id}`);

        const isVisible = content.style.display === "table-row";
        content.style.display = isVisible ? "none" : "table-row";
        arrow.textContent = isVisible ? "▶" : "▼";
    });
});
</script>
