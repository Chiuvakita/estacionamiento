{% load static %}
{% include "navbarAdmin.html" %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Listado de Empresas</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>
    <div class="actions" style="margin: 10px 0;">
        <a class="button" href="{% url 'empresas_crear' %}">Crear nueva empresa</a>
    </div>

    <h1>Listado de Empresas</h1>

    <table>
        <thead>
            <tr>
                <th>Nombre</th>
            </tr>
        </thead>
        <tbody>
            {% for empresa in empresas %}
            <tr class="accordion-header" data-id="{{ empresa.id }}" style="cursor:pointer;">
                <td style="display:flex; justify-content:space-between; align-items:center;">
                    <div>
                        <span class="arrow" id="arrow-{{ empresa.id }}">▶</span>
                        <strong>{{ empresa.nombre }}</strong>
                    </div>

                    <a class="button" href="{% url 'sucursales_listar' empresa.id %}">Ver Sucursales</a>
                </td>
            </tr>

            <tr class="accordion-content" id="content-{{ empresa.id }}" style="display:none;">
                <td>
                    <p><strong>Teléfono:</strong> {{ empresa.telefono }}</p>
                    <p><strong>Correo:</strong> {{ empresa.correo }}</p>
                    <p><strong>Dirección:</strong> {{ empresa.direccion }}</p>

                    <div style="display:flex; gap:10px;">
                        <a class="button" href="{% url 'empresas_editar' empresa.id %}">Editar</a>
                        <form action="{% url 'empresas_eliminar' empresa.id %}" method="POST">
                            {% csrf_token %}
                            <button class="button button-danger" type="submit"
                                onclick="return confirm('¿Eliminar empresa?');">Eliminar</button>
                        </form>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>

<script>
document.querySelectorAll(".accordion-header").forEach(header => {
    header.addEventListener("click", () => {
        const id = header.getAttribute("data-id");
        const content = document.getElementById(`content-${id}`);
        const arrow = document.getElementById(`arrow-${id}`);

        const isVisible = content.style.display === "table-row";
        content.style.display = isVisible ? "none" : "table-row";
        arrow.textContent = isVisible ? "▶" : "▼";
    });
});
</script>

</html>
