{% include "navbarAdmin.html" %}
{% load static %}
{% block content %}

<h1>Listado de Estacionamientos</h1>

<div class="card">
  <a href="{% url 'crearEstacionamiento' %}" class="button">Crear</a>
  <a href="{% url 'crearEstacionamientosMasivo' %}" class="button">Crear masivo</a>

  <form method="post" action="{% url 'eliminarTodosEstacionamientos' %}" style="display:inline;">
    {% csrf_token %}
    <button type="submit" class="button button-danger">Eliminar todos</button>
  </form>
</div>

<table>
  <tr><th>ID</th><th>Estado</th><th>Tipo</th><th>Patente</th><th>Acciones</th></tr>
  {% for e in estacionamientos %}
  <tr>
    <td>{{ e.id }}</td>
    <td>{{ e.get_estado_display }}</td>
    <td>{{ e.tipo }}</td>
    <td>{{ e.patente|default:"-" }}</td>
    <td>
      <a href="{% url 'editarEstacionamiento' e.id %}" class="button">Editar</a>

      <form method="post" action="{% url 'eliminarEstacionamiento' e.id %}" style="display:inline;">
        {% csrf_token %}
        <button 
          type="submit" 
          class="button button-danger" 
          data-espacio-id="{{ e.id }}">
          Eliminar
        </button>
      </form>
    </td>
  </tr>
  {% endfor %}
</table>

<script src="{% static 'js/validaciones.js' %}"></script>
<script>
  document.querySelectorAll(".button-danger").forEach(btn =>
    btn.addEventListener("click", confirmarAccion)
  );
</script>

{% endblock %}
